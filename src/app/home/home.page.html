<ion-header [translucent]="true">
  
  <ion-toolbar color="danger">
    <ion-title>
      Blassa 
    </ion-title>
   
    <ion-buttons slot="secondary">
      <ion-button (click)="Logout()">
        <ion-icon slot="icon-only" name="contact"  ></ion-icon>
      </ion-button>
      <ion-button>
        <ion-icon slot="icon-only" name="search"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  <span style="font-size: 14px">Welcome {{email}} >> Dashboard</span>
</ion-header>


 
   <ion-content class="ion-padding"> 

   
    
        <ion-tabs>
          <ion-tab-bar slot="fixed">
            <ion-tab-button tab="home">
              <ion-icon name="speedometer"></ion-icon>
              <ion-label>Dashboard</ion-label>
            </ion-tab-button>
      
            <ion-tab-button tab="news">
              <ion-icon name="list"></ion-icon>
              <ion-label>News</ion-label>
            </ion-tab-button>
          </ion-tab-bar>
        </ion-tabs>
    

<span *ngIf="isDriver && !isAdmin" vertical="top">
  

              <ion-item>
                
                <ion-select placeholder="Choisir votre destination" [(ngModel)]="Destination">
                  <ion-select-option value="KT">Tunis</ion-select-option>
                  <ion-select-option value="TK">Kébili</ion-select-option>
                </ion-select>
            
                   
                  <ion-datetime placeholder="Date du voyage" (ionChange)="dateChanged()" [(ngModel)]="DateVoyage" displayFormat="DD-MM-YYYY" pickerFormat="DD MM YYYY">
                      </ion-datetime>
                  </ion-item>
              
           
                <ion-item>
            <ion-label>{{ResNbr}} réservations </ion-label>
            </ion-item>
         <ion-grid>
        <ion-row *ngFor="let resv of Reservations">
            <ion-col>
                <ion-item>
                    
                    <ion-card >
                        <ion-card-header>
                          <ion-card-title></ion-card-title>
                         
                        </ion-card-header>
                        <ion-card-content>
                         Tel:{{resv.ResTel}} Au nom de:{{resv.ResUserName}}
                        </ion-card-content>
                    </ion-card> 
                </ion-item>
            </ion-col>
        </ion-row>

    </ion-grid>

  </span>

<span *ngIf="!isDriver && !isAdmin" vertical="top">
    
           <ion-item>
                <ion-select [(ngModel)]="Direction" (ionChange)="DirChange()">
                  <ion-select-option value="KT">Tunis</ion-select-option>
                  <ion-select-option value="TK">Kébili</ion-select-option>
                </ion-select>
           </ion-item>
           <ion-item>
                <ion-select [(ngModel)]="selected_value0" (ionChange)="latlngChange(selected_value0)">
                  <ion-select-option *ngFor="let date_voyage of DatesVoyages" [value]="date_voyage.email">
                    {{date_voyage.Date_depart}}:{{date_voyage.email}}
                  </ion-select-option>
                </ion-select>
           </ion-item>
                 
    <agm-map [zoom]="18" [latitude]="latme" [longitude]="lngme" class="MyAgm"   #AgmMap [mapTypeId]="'hybrid'">
      <agm-marker *ngFor="let position of Drivers; let i = index" [latitude]="position.lat" [longitude]="position.lng" [label]="position.Dir"
         (markerClick)="onMarkerClick(position)"  >
         <agm-info-window #infowindow>
          <strong>{{position.email}}</strong>
        </agm-info-window>
        
        
        </agm-marker>
    </agm-map>           
          
 </span>

      


 <span *ngIf="isAdmin && !isDriver"> 
  <ion-card  *ngFor="let item of Users">
    <span *ngIf="!item.isEdit; else elseBlock">
      <ion-card-header>
        <ion-card-title>{{item.email}} of {{item.Tel}}</ion-card-title>
        <ion-card-subtitle>Est un: {{item.driver}}</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
 
        <ion-button shape="round" color="secondary" size="small" (click)="EditRecord(item)">
          <ion-icon size="small" slot="icon-only" name="create"></ion-icon>
 
        </ion-button>
        <ion-button shape="round" color="danger" size="small" (click)="RemoveRecord(item.id)">
          <ion-icon size="small" slot="icon-only" name="trash"></ion-icon>
 
        </ion-button>
      </ion-card-content>
    </span>
   <ng-template #elseBlock>
      <ion-card-header>
        <ion-card-title>
          <ion-grid>
            <ion-row>
              <ion-col>
                Edit
              </ion-col>
              <ion-col>
                <ion-button fill="clear" color="medium" size="small" (click)="item.isEdit = false">
                  Cancel
                </ion-button>
              </ion-col>
              <ion-col>
                <ion-button fill="outline" color="success" size="small" (click)="UpdateRecord(item)">
                  Update
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label><strong>Nom (Email)</strong></ion-label>
          <ion-input type="text" [(ngModel)]="item.email"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label><strong>Tel</strong></ion-label>
          <ion-input type="text" [(ngModel)]="item.Tel"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label><strong>Nature</strong></ion-label>
          <ion-input type="text" [(ngModel)]="item.driver"></ion-input>
        </ion-item>
      </ion-card-content>
    </ng-template>
  </ion-card>

  <ion-button expand="block" fill="clear" routerLink="/register">
    Create a new account
  </ion-button>

 </span>




</ion-content>
